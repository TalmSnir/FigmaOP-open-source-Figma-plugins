(()=>{"use strict";const e={warning:{reject:"✘ something went wrong please run again"},success:{createIndex:"✔ index has been created successfully",createPages:"✔ new pages have been added successfully",deletePages:"✔ selected pages have been deleted successfully",updatedTemplate:"✔ templates has been updated successfully",newTemplate:"✔ new template has been created successfully",deletedTemplate:"✔ template has been deleted successfully",updatePages:"✔ pages list has been updated successfully"}};function t(){let t;return{showNotification:(n,a)=>{t&&t.cancel(),t=figma.notify(e[n][a],{timeout:2e3})},postMessageToPlugin:(e,t)=>{parent.postMessage({pluginMessage:{msg:e,data:t}},"*")},postMessageToUI:(e,t)=>{figma.ui.postMessage({msg:e,data:t})}}}var n=function(e,t,n,a){return new(n||(n=Promise))((function(i,o){function s(e){try{r(a.next(e))}catch(e){o(e)}}function c(e){try{r(a.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}r((a=a.apply(e,t||[])).next())}))};function a({fontName:e={family:"Roboto",style:"Regular"},characters:t="",fontSize:n=16,hyperlink:a=null}){const i=figma.createText();return i.fontName=e,i.characters=t,i.fontSize=n,i.hyperlink=a,i}var i=function(e,t,n,a){return new(n||(n=Promise))((function(i,o){function s(e){try{r(a.next(e))}catch(e){o(e)}}function c(e){try{r(a.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}r((a=a.apply(e,t||[])).next())}))};figma.showUI(__html__,{width:300,height:400});const{postMessageToUI:o,showNotification:s}=t(),{getFromStorage:c,saveToStorage:r}=function(){const{showNotification:e}=t();return{saveToStorage:(t,a)=>n(this,void 0,void 0,(function*(){try{yield figma.clientStorage.setAsync(t,JSON.stringify(a))}catch(t){console.log("in saveToStorage catch: ",t),e("warning","reject")}})),getFromStorage:t=>n(this,void 0,void 0,(function*(){try{const e=yield figma.clientStorage.getAsync(t);return JSON.parse(e)}catch(t){console.log("in getFromStorage catch: ",t),e("warning","reject")}}))}}();let g,l;function u(e,t){l=t,s("success",e)}function d(){g=figma.root.children;const e=g.map((e=>({name:e.name,id:e.id})));o("pages",e)}function f(e=null){m=figma.currentPage,e&&s("success",e),d()}figma.ui.onmessage=e=>{const{msg:t,data:n}=e,o={deletePages:()=>function(e,t){const n=g.filter((e=>t.includes(e.id)));if(g=g.filter((e=>!t.includes(e.id))),0===g.length){const e=figma.createPage();e.name="page 1",figma.currentPage=e}else figma.currentPage=n.find((e=>e.id===m.id))?g[0]:m;for(;n.length>0;)n.pop().remove();d(),s("success",e)}(t,n),createPages:()=>function(e,t){t.forEach((e=>{const t=figma.createPage();e=e.trim(),t.name="-"===e[0]&&"-"===e[e.length-1]?`— — — — ${e.replace("-","")}— — — — `:e})),d(),s("success",e)}(t,n),createIndex:()=>function(e){return i(this,void 0,void 0,(function*(){yield figma.loadFontAsync({family:"Roboto",style:"Regular"});const t=figma.createFrame();t.name="Pages Index",function(e,{layoutMode:t="HORIZONTAL",primaryAxisSizingMode:n="AUTO",counterAxisSizingMode:a="AUTO",primaryAxisAlignItems:i="MIN",counterAxisAlignItems:o="MIN",itemSpacing:s=32,padding:c=[16,16,16,16]}){e.layoutMode=t,e.primaryAxisSizingMode=n,e.counterAxisSizingMode=a,e.primaryAxisAlignItems=i,e.counterAxisAlignItems=o,e.itemSpacing=s,e.paddingTop=c[0],e.paddingRight=c[1],e.paddingBottom=c[2],e.paddingLeft=c[3]}(t,{layoutMode:"VERTICAL",primaryAxisSizingMode:"AUTO",counterAxisSizingMode:"AUTO",primaryAxisAlignItems:"MIN",counterAxisAlignItems:"MIN",itemSpacing:32,padding:[16,32,16,32]});const n=a({fontName:{family:"Roboto",style:"Regular"},characters:"pages index",fontSize:24});t.appendChild(n),g.forEach(((e,n)=>{const i=a({fontName:{family:"Roboto",style:"Regular"},characters:`${n+1}. ${e.name}`,fontSize:16,hyperlink:{type:"NODE",value:e.id}});t.appendChild(i)})),s("success",e)}))}(t),newTemplate:()=>u(t,n),updatedTemplate:()=>u(t,n),deletedTemplate:()=>u(t,n),updatePages:()=>f(t)};o[t]()};let m=figma.currentPage;figma.on("run",(function(){return i(this,void 0,void 0,(function*(){const e=yield c("templates");l=e||[],d(),o("templates",l)}))})),figma.on("close",(function(){return i(this,void 0,void 0,(function*(){yield r("templates",l)}))})),figma.on("currentpagechange",f)})();